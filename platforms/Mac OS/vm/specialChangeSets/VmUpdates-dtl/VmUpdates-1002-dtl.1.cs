'From Squeak3.9 of 7 November 2006 [latest update: #7067] on 23 April 2007 at 2:11:23 pm'!"Change Set:		VmUpdates-1002-dtlDate:			23 April 2007Author:			David T. LewisDeclare globals for oops in ObjectMemory and Interpreter as type usqInt."!!ObjectMemory class methodsFor: 'translation' stamp: 'dtl 4/14/2007 16:14'!declareCAsOop: arrayOfVariableNames in: aCCodeGenerator	"Declare the variables in arrayOfVariableNames with type representing position in object memory."	arrayOfVariableNames		do: [:varName | aCCodeGenerator var: varName type: 'usqInt']! !!ObjectMemory class methodsFor: 'translation' stamp: 'dtl 4/22/2007 17:50'!declareCVarsIn: aCCodeGenerator	aCCodeGenerator var: #memory type:#'usqInt'.	aCCodeGenerator		var: #remapBuffer		declareC: 'sqInt remapBuffer[', (RemapBufferSize + 1) printString, ']'.	aCCodeGenerator		var: #rootTable		declareC: 'sqInt rootTable[', (RootTableSize + 1) printString, ']'.	"Weak roots must be large enough for roots+remapBuffer+sizeof(allCallsOn: #markAndTrace:)"	aCCodeGenerator		var: #weakRoots		declareC: 'sqInt weakRoots[', (RootTableSize + RemapBufferSize + 100) printString, ']'.	aCCodeGenerator		var: #headerTypeBytes		declareC: 'sqInt headerTypeBytes[4]'.	self declareCAsOop: {			#youngStart .			#endOfMemory .			#memoryLimit .			#youngStartLocal .			#freeBlock .			#compStart .			#compEnd .			#fwdTableNext .			#fwdTableLast .			#gcBiasToGrowThreshold }		in: aCCodeGenerator! !!Interpreter class methodsFor: 'translation' stamp: 'dtl 4/14/2007 16:15'!declareCVarsIn: aCCodeGenerator	aCCodeGenerator 		var: #interpreterProxy 		type: #'struct VirtualMachine*'.	aCCodeGenerator		var: #primitiveTable		declareC: 'void *primitiveTable[', (MaxPrimitiveIndex +2) printString, '] = ',	self primitiveTableString.	aCCodeGenerator		var: #primitiveFunctionPointer		declareC: 'void *primitiveFunctionPointer'				.		"xxxx FIX THIS STUPIDITY xxxx - ikp. What he means is use a better type than void *, apparently - tpr"	aCCodeGenerator		var: #methodCache		declareC: 'long methodCache[', (MethodCacheSize + 1) printString, ']'.	aCCodeGenerator		var: #atCache		declareC: 'sqInt atCache[', (AtCacheTotalSize + 1) printString, ']'.	aCCodeGenerator var: #localIP type: #'char*'.	aCCodeGenerator var: #localSP type: #'char*'.	aCCodeGenerator var: #showSurfaceFn type: #'void*'.	aCCodeGenerator var: 'semaphoresToSignalA'		declareC: 'sqInt semaphoresToSignalA[', (SemaphoresToSignalSize + 1) printString, ']'.	aCCodeGenerator var: 'semaphoresToSignalB'		declareC: 'sqInt semaphoresToSignalB[', (SemaphoresToSignalSize + 1) printString, ']'.	aCCodeGenerator		var: #compilerHooks		declareC: 'sqInt (*compilerHooks[', (CompilerHooksSize + 1) printString, '])()'.	aCCodeGenerator		var: #interpreterVersion		declareC: 'const char *interpreterVersion = "', SmalltalkImage current datedVersion, ' [', SmalltalkImage current lastUpdateString,']"'.	aCCodeGenerator		var: #obsoleteIndexedPrimitiveTable		declareC: 'char* obsoleteIndexedPrimitiveTable[][3] = ', self obsoleteIndexedPrimitiveTableString.	aCCodeGenerator		var: #obsoleteNamedPrimitiveTable		declareC: 'const char* obsoleteNamedPrimitiveTable[][3] = ', self obsoleteNamedPrimitiveTableString.	aCCodeGenerator		var: #externalPrimitiveTable		declareC: 'void *externalPrimitiveTable[', (MaxExternalPrimitiveTableSize + 1) printString, ']'.	self declareCAsOop: {			#instructionPointer .			#method .			#newMethod .			#activeContext .			#theHomeContext .			#stackPointer }		in: aCCodeGenerator! !